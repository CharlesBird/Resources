<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!-- 买入 -->
        <record id="view_linyan_contract_form" model="ir.ui.view">
            <field name="name">linyan.contract.form</field>
            <field name="model">linyan.contract</field>
            <field name="arch" type="xml">
                <form string="Contract Form">
                    <header>
                        <button name="action_sign" states="draft" string="确认签订" type="object"/>
                        <button name="action_moved" states="sign,paid" string="提货完结" type="object" confirm="确定提货完结了吗？"/>
                        <button name="action_paid" states="sign,moved" string="付款完结" type="object" confirm="确定付款完结了吗？"/>
                        <button name="action_done" type="object" string="设置为完成" states="sign,moved,paid"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,sign,moved,paid,done"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button type="object" name="action_view_delivery" class="oe_stat_button" icon="fa-truck" attrs="{'invisible': [('delivery_count', '=', 0)]}" groups="base.group_user">
                                <field name="delivery_count" widget="statinfo" string="物流"/>
                            </button>
                            <button name="action_view_invoice" type="object" class="oe_stat_button" icon="fa-pencil-square-o" attrs="{'invisible': [('invoice_count', '=', 0)]}">
                                <field name="invoice_count" widget="statinfo" string="发票"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="partner_id" options="{'no_create': True}"/>
                                <field name="contract_name"/>
                                <field name="contract_date"/>
                                <label for="year" string="年月"/>
                                <div>
                                    <field name="year" class="oe_inline"/>
                                    <label string="年"/>
                                    <field name="month" class="oe_inline"/>
                                    <label string="月"/>
                                </div>
                                <field name="price"/>
                                <field name="untax_price"/>
                                <field name="actual_qty" string="拟定数量"/>
                                <field name="qty_delivered" string="实际数量"/>
                                <field name="remaining_qty"/>
                                <field name="qty_to_delivered"/>
                                <field name="amount"/>
                                <field name="unpayment_amount"/>
                                <field name="contract_amount"/>
                                <field name="profit"/>
                            </group>
                            <group>
                                <field name="account_ref"/>
                                <label for="payment_method"/>
                                <div>
                                    <field name="payment_method" class="oe_inline"/>
                                    <field name="days" class="oe_inline"/>
                                    <label string="天"/>
                                </div>
                                <field name="journal_id" options="{'no_create': True, 'no_open': True}"/>
                                <field name="tax_ids" widget="many2many_tags" options="{'no_create': True, 'no_open': True}"/>
                                <field name="currency_id" options="{'no_create': True, 'no_open': True}"/>
                                <field name="currency_rate" invisible="1"/>
                                <field name="oversell" attrs="{'invisible':[('buy','=',True)]}"/>
                                <field name="cash"/>
                                <field name="big_contract"/>
                                <field name="picking"/>
                                <field name="invoice_status"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="关联订单" attrs="{'invisible':[('buy','!=',False)]}">
                                <field name="contract_line">
                                    <tree editable="top">
                                        <field name="product_id" options="{'no_create': True, 'no_open': True}"/>
                                        <field name="buy_id" options="{'no_create': True, 'no_open': True}" context="{'product_id': parent.product_id, 'contract_line': parent.contract_line}"/>
                                        <field name="model_id" options="{'no_create': True, 'no_open': True}"/>
                                        <field name="packaging_id" options="{'no_create': True, 'no_open': True}"/>
                                        <field name="brand_id"/>
                                        <field name="price"/>
                                        <field name="relation_qty"/>
                                        <field name="actual_qty"/>
                                        <field name="used_qty"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="商品信息" attrs="{'invisible':[('buy','=',False),('oversell','=',False)]}">
                                <group>
                                    <group>
                                        <field name="product_id" options="{'no_create': True}"/>
                                        <field name="model_id" options="{'no_create': True}"/>
                                    </group>
                                    <group>
                                        <field name="packaging_id" options="{'no_create': True}"/>
                                        <field name="brand_id"/>
                                        <field name="protocol_qty" invisible="1"/>
                                        <field name="used_qty" invisible="1"/>
                                    </group>
                                </group>
                            </page>
                            <page string="卖出合同" invisible="1">
                                <field name="sell_ids"/>
                            </page>
                            <page string="卖出合同" attrs="{'invisible':[('buy','=',False)]}">
                                <field name="sale_contract_line">
                                    <tree editable="top">
                                        <field name="product_id"/>
                                        <field name="sale_id"/>
                                        <field name="brand_id"/>
                                        <field name="model_id"/>
                                        <field name="packaging_id"/>
                                        <field name="contract_qty"/>
                                        <field name="relation_qty"/>
                                        <field name="actual_qty"/>
                                        <field name="price"/>
                                        <field name="untax_price"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="其他信息">
                                <group>
                                    <group string="物流信息" invisible="1">
                                        <field name="goods"/>
                                        <field name="move_ids"/>
                                    </group>
                                    <group string="发票" invisible="1">
                                        <field name="account_date"/>
                                        <field name="invoice_lines"/>
                                    </group>
                                    <group string="基础信息">
                                        <field name="linyan"/>
                                        <field name="version"/>
                                        <field name="write_uid" readonly="1"/>
                                        <field name="write_date" readonly="1"/>
                                        <field name="buy" invisible="1"/>
                                        <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                    </group>
                                </group>
                                <field name="note" placeholder="备注"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="view_linyan_contract_tree" model="ir.ui.view">
            <field name="name">linyan.contract.tree</field>
            <field name="model">linyan.contract</field>
            <field name="arch" type="xml">
                <tree string="Contract">
                    <field name="name"/>
                    <field name="product_id"/>
                    <field name="brand_id"/>
                    <field name="partner_id"/>
                    <field name="year"/>
                    <field name="month"/>
                    <field name="actual_qty" string="拟定数量"/>
                    <field name="qty_to_delivered"/>
                    <field name="price"/>
                    <field name="amount"/>
                    <field name="unpayment_amount"/>
                    <field name="profit" sring="销售利润"/>
                    <field name="remaining_qty" string="头寸数量"/>
                    <field name="write_uid"/>
                    <field name="write_date"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_linyan_contract_search" model="ir.ui.view">
            <field name="name">linyan.contract.search</field>
            <field name="model">linyan.contract</field>
            <field name="arch" type="xml">
                <search string="Contract Search">
                    <field name="product_id"/>
                    <field name="state"/>
                    <field name="partner_id"/>
                    <field name="name"/>
                    <field name="brand_id"/>
                    <filter name="unmoved" string="未完成提货" domain="[('state','in',('draft', 'sign'))]"/>
                    <filter name="uncash" string="未完成成本头寸" domain="[('cash','!=',True)]"/>
                    <filter name="unpaid" string="未完成发票" domain="[('state','in',('draft', 'sign', 'moved'))]"/>
                    <group expand="0" string="Group By">
                        <filter name="year" string="状态" context="{'group_by':'state'}"/>
                        <filter name="month" string="状态" context="{'group_by':'state'}"/>
                        <filter name="status" string="状态" context="{'group_by':'state'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_linyan_contract_kanban">
            <field name="name">linyan.contract.kanban</field>
            <field name="model">linyan.contract</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="product_id"/>
                    <field name="brand_id"/>
                    <field name="actual_qty"/>
                    <field name="qty_delivered"/>
                    <field name="price"/>
                    <field name="qty_to_delivered"/>
                    <field name="remaining_qty"/>
                    <field name="unpayment_amount"/>
                    <field name="state"/>
                    <field name="buy"/>
                    <field name="currency_id"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <strong><span><t t-esc="record.product_id.value"/><t t-esc="record.name.value.split('P')[0] == 'LY' and record.name.value.split('LYP')[1] or record.name.value.split('LYS')[1]"/></span></strong>
                                    </div>
                                    <div class="col-xs-6 pull-right text-right">
                                        <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-9">
                                        <span>数量/单价:<t t-esc="record.qty_delivered.value != 0.0 and record.qty_delivered.value or record.actual_qty.value"/>/<t t-esc="record.price.value"/></span>
                                    </div>
                                    <div class="col-xs-3">
                                        <span t-attf-class="pull-right text-right">品牌:<t t-esc="record.brand_id and record.brand_id.value or False"/></span>
                                        <!-- <span t-attf-class="pull-right text-right"><field name="actual_qty"/>/<field name="qty_delivered"/>/<field name="price" widget="monetary"/></span> -->
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-9">
                                        <strong>未提/未售:<field name="qty_to_delivered"/>/<field name="remaining_qty"/></strong>
                                    </div>
                                    <div class="col-xs-3">
                                        <span t-attf-class="pull-right text-right">状态:<t t-esc="record.state.value"/></span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="action_view_linyan_contract_buy" model="ir.actions.act_window">
            <field name="name">买入合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">linyan.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="view_linyan_contract_tree"/>
            <field name="search_view_id" ref="view_linyan_contract_search"/>
            <field name="domain">[('buy', '=', 1)]</field>
            <field name="context">{'default_buy': 1}</field>
        </record>

        <record id="action_view_linyan_contract_sale" model="ir.actions.act_window">
            <field name="name">卖出合同</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">linyan.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="view_linyan_contract_tree"/>
            <field name="search_view_id" ref="view_linyan_contract_search"/>
            <field name="domain">[('buy', '=', 0)]</field>
            <field name="context">{'default_buy': 0}</field>
        </record>

        <menuitem id="menu_action_view_linyan_contract_buy" name="买入合同" parent="linyan_base.menu_linyan_base_buy_sale" action="action_view_linyan_contract_buy" sequence="10"/>
        <menuitem id="menu_action_view_linyan_contract_sale" name="卖出合同" parent="linyan_base.menu_linyan_base_buy_sale" action="action_view_linyan_contract_sale" sequence="20"/>

        <!-- <menuitem id="menu_action_view_linyan_contract_buy" name="买入合同" parent="linyan_base.menu_linyan_base_buy" action="action_view_linyan_contract_buy" sequence="30"/>
        <menuitem id="menu_action_view_linyan_contract_sale" name="卖出合同" parent="linyan_base.menu_linyan_base_sale" action="action_view_linyan_contract_sale" sequence="30"/> -->

        <!-- 物流 -->
        <record id="view_logistics_move_form" model="ir.ui.view">
            <field name="name">logistics.move.form</field>
            <field name="model">logistics.move</field>
            <field name="arch" type="xml">
                <form string="Logistics Form">
                    <header>
                        <button name="action_plan" states="draft" string="计划" type="object"/>
                        <button name="action_done" states="plan" string="执行" type="object"/>
                        <button name="action_cancel" states="draft" string="取消" type="object"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,plan,done"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group string="一般信息">
                            <group>
                                <field name="product_id"/>
                                <field name="brand_id"/>
                                <field name="model_id"/>
                            </group>
                            <group>
                                <field name="protocol_qty"/>
                                <field name="actual_qty"/>
                            </group>
                        </group>
                        <group string="提货信息">
                            <group>
                                <field name="partner_id"/>
                                <field name="warehouse_src_id"/>
                                <field name="date"/>
                            </group>
                            <group>
                                <field name="contract_id" context="{'product_id': product_id, 'partner_id': partner_id}"/>
                                <field name="warehouse_addr"/>
                                <field name="date_done"/>
                            </group>
                        </group>
                        <group string="发货信息">
                            <group>
                                <field name="partner_id2"/>
                                <field name="warehouse_dest_id"/>
                                <field name="date2"/>
                            </group>
                            <group>
                                <field name="contract_id2" context="{'product_id': product_id}"/>
                                <field name="warehouse_addr2"/>
                                <field name="date_done2"/>
                            </group>
                        </group>
                        <group string="承运信息">
                            <group>
                                <field name="trasport"/>
                                <field name="trasport_user"/>
                            </group>
                            <group>
                                <field name="untax_price"/>
                                <field name="origin"/>
                                <field name="move_out" invisible="1"/>
                                <field name="move_in" invisible="1"/>
                                <field name="write_uid" readonly="1"/>
                                <field name="write_date" readonly="1"/>
                                <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="view_linyan_logistics_move_tree" model="ir.ui.view">
            <field name="name">logistics.move.tree</field>
            <field name="model">logistics.move</field>
            <field name="arch" type="xml">
                <tree string="Logistics">
                    <field name="name"/>
                    <field name="contract_id"/>
                    <field name="partner_id"/>
                    <field name="date" string="计划提货日期"/>
                    <field name="warehouse_src_id" string="出货仓库"/>
                    <field name="contract_id2"/>
                    <field name="partner_id2"/>
                    <field name="warehouse_dest_id" string="入库仓库"/>
                    <field name="product_id"/>
                    <field name="brand_id"/>
                    <field name="protocol_qty"/>
                    <field name="actual_qty"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_linyan_logistics_move_search" model="ir.ui.view">
            <field name="name">logistics.move.search</field>
            <field name="model">logistics.move</field>
            <field name="arch" type="xml">
                <search string="Logistics Move">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="contract_id"/>
                    <field name="product_id"/>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_linyan_logistics_move_kanban">
            <field name="name">logistics.move.kanban</field>
            <field name="model">logistics.move</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="partner_id2"/>
                    <field name="warehouse_src_id"/>
                    <field name="product_id"/>
                    <field name="protocol_qty"/>
                    <field name="actual_qty"/>
                    <field name="state"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <strong><span>买入伙伴:<t t-esc="record.partner_id and record.partner_id.value"/></span></strong>
                                    </div>
                                    <div class="col-xs-6 pull-right text-right">
                                        <strong><span>卖出伙伴:<t t-esc="record.partner_id2 and record.partner_id2.value"/></span></strong>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-9">
                                        <strong>计划数量/实际数量:<field name="protocol_qty"/>/<field name="actual_qty"/></strong>
                                    </div>
                                    <div class="col-xs-3">
                                        <span t-attf-class="pull-right text-right">商品:<t t-esc="record.product_id.value"/></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <span>源仓库:<t t-esc="record.warehouse_src_id and record.warehouse_src_id.value"/></span>
                                    </div>
                                    <div class="col-xs-6">
                                        <span t-attf-class="pull-right text-right">状态:<t t-esc="record.state.value"/></span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="action_view_linyan_logistics_move" model="ir.actions.act_window">
            <field name="name">物流</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">logistics.move</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_id" ref="view_linyan_logistics_move_tree"/>
            <field name="search_view_id" ref="view_linyan_logistics_move_search"/>
        </record>

        <menuitem id="menu_action_view_linyan_logistics_move" name="物流" parent="linyan_base.menu_linyan_base_logistics" action="action_view_linyan_logistics_move" sequence="10"/>

        <record id="view_linyan_account_payment_form" model="ir.ui.view">
            <field name="name">account.payment.form.inherit</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='communication']" position="after">
                    <field name="face_date"/>
                </xpath>
            </field>
        </record>

        <record id="view_linyan_stock_warehouse_form" model="ir.ui.view">
            <field name="name">stock.warehouse.form.inherit</field>
            <field name="model">stock.warehouse</field>
            <field name="inherit_id" ref="stock.view_warehouse"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='code']" position="after">
                    <field name="is_ower"/>
                </xpath>
            </field>
        </record>

        <!-- 客户应收 -->
        <record id="linyan_invoice_tree" model="ir.ui.view">
            <field name="name">linyan.invoice.tree</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <tree string="Invoice">
                    <field name="partner_id" groups="base.group_user" string="客户"/>
                    <field name="contract_id"/>
                    <field name="product_id"/>
                    <field name="move_id"/>
                    <field name="amount_total"/>
                    <field name="residual"/>
                    <field name="name"/>
                    <field name="journal_id"/>
                    <field name="date_due"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="invoice_type" invisible="context.get('type',True)"/>
                </tree>
            </field>
        </record>

        <record id="linyan_invoice_form" model="ir.ui.view">
            <field name="name">linyan.invoice.form</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <form string="Invoice">
                <sheet string="Invoice">
                    <h1 class="mt0">
                        <field name="name" readonly="1" class="oe_inline"/>
                    </h1>
                    <field name="invoice_type" invisible="1"/>
                    <group>
                        <group>
                            <field string="客户" name="partner_id" domain="[('customer', '=', True)]"/>
                            <field name="contract_id" options="{'no_create': True}"/>
                            <field name="move_id" options="{'no_create': True}"/>
                            <field name="date_invoice"/>
                            <field name="date_due"/>
                            <field name="origin" groups="base.group_user" attrs="{'invisible': [('origin', '=', False)]}"/>
                        </group>
                        <group>
                            <field name="journal_id" options="{'no_create': True}"/>
                            <field name="tax_ids" widget="many2many_tags" options="{'no_create': True, 'no_open': True}"/>
                            <field name="amount_untaxed"/>
                            <field name="amount_total"/>
                            <field name="residual"/>
                            <field name="user_id" groups="base.group_user" options="{'no_create': True}"/>
                            <label for="currency_id" groups="base.group_multi_currency"/>
                            <div groups="base.group_multi_currency">
                                <field name="currency_id" options="{'no_create': True, 'no_open': True}" class="oe_inline"/>
                            </div>
                            <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="实收">
                            <field name="invoice_line">
                                <tree string="Payments" editable="bottom">
                                    <field name="payment_id" options="{'no_create': True}"/>
                                    <field name="journal_id"/>
                                    <field name="amount"/>
                                    <field name="used_amount"/>
                                    <field name="remaining_amount"/>
                                    <field name="payment_date"/>
                                    <field name="currency_id" invisible="1"/>
                                </tree>
                            </field>
                            <field name="comment" placeholder="Terms and conditions..."/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>

        <!-- 供应商应付 -->
        <record id="linyan_invoice_supplier_tree" model="ir.ui.view">
            <field name="name">linyan.invoice.supplier.tree</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <tree string="Invoice">
                    <field name="partner_id" groups="base.group_user" string="供应商"/>
                    <field name="contract_id"/>
                    <field name="product_id"/>
                    <field name="move_id"/>
                    <field name="amount_total"/>
                    <field name="residual"/>
                    <field name="name"/>
                    <field name="journal_id"/>
                    <field name="date_due"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="invoice_type" invisible="context.get('type',True)"/>
                </tree>
            </field>
        </record>

        <record id="linyan_invoice_supplier_form" model="ir.ui.view">
            <field name="name">linyan.invoice.supplier.form</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <form string="Vendor Invoice">
                <sheet string="Invoice">
                    <h1 class="mt0">
                        <field name="name" readonly="1" class="oe_inline"/>
                    </h1>
                    <field name="invoice_type" invisible="1"/>
                    <group>
                        <group>
                            <field string="供应商" name="partner_id" domain="[('customer', '=', True)]"/>
                            <field name="contract_id" options="{'no_create': True}"/>
                            <field name="move_id"/>
                            <field name="date_invoice"/>
                            <field name="date_due"/>
                            <field name="origin" groups="base.group_user" attrs="{'invisible': [('origin', '=', False)]}"/>
                        </group>
                        <group>
                            <field name="journal_id" options="{'no_create': True}"/>
                            <field name="tax_ids" widget="many2many_tags" options="{'no_create': True, 'no_open': True}"/>
                            <field name="amount_untaxed"/>
                            <field name="amount_total"/>
                            <field name="residual"/>
                            <field name="user_id" groups="base.group_user"/>
                            <label for="currency_id" groups="base.group_multi_currency"/>
                            <div groups="base.group_multi_currency">
                                <field name="currency_id" options="{'no_create': True, 'no_open': True}" class="oe_inline"/>
                            </div>
                            <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="实付">
                            <field name="invoice_line">
                                <tree string="Payments" editable="bottom">
                                    <field name="payment_id" options="{'no_create': True}"/>
                                    <field name="journal_id"/>
                                    <field name="amount"/>
                                    <field name="used_amount"/>
                                    <field name="remaining_amount"/>
                                    <field name="payment_date"/>
                                    <field name="currency_id" invisible="1"/>
                                </tree>
                            </field>
                            <field name="comment" placeholder="Terms and conditions..."/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>

        <record id="view_linyan_invoice_filter" model="ir.ui.view">
            <field name="name">linyan.invoice.select</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <search string="Search Invoice">
                    <field name="journal_id" />
                    <field name="partner_id" operator="child_of"/>
                    <field name="user_id" string="Salesperson"/>
                    <field name="date_invoice" string="Period"/>
               </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_linyan_invoice_kanban">
            <field name="name">linyan.invoice.kanban</field>
            <field name="model">linyan.invoice</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="product_id"/>
                    <field name="partner_id"/>
                    <field name="invoice_type"/>
                    <field name="amount_total"/>
                    <field name="date_invoice"/>
                    <field name="currency_id"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                    </div>
                                    <div class="col-xs-6 pull-right text-right">
                                        <strong><field name="amount_total" widget="monetary"/></strong>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <span><t t-esc="record.product_id.value"/></span>
                                    </div>
                                    <div class="col-xs-6">
                                        <span t-attf-class="pull-right text-right"><t t-esc="record.date_invoice.value"/></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <span><t t-esc="record.name.value"/></span>
                                    </div>
                                    <div class="col-xs-6">
                                        <span t-attf-class="pull-right text-right"><t t-esc="record.invoice_type.value"/></span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="action_linyan_invoice_tree1" model="ir.actions.act_window">
            <field name="name">应收发票</field>
            <field name="res_model">linyan.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field eval="False" name="view_id"/>
            <field name="domain">[('invoice_type','=','out_invoice')]</field>
            <field name="context">{'default_invoice_type':'out_invoice', 'type':'out_invoice'}</field>
            <field name="search_view_id" ref="view_linyan_invoice_filter"/>
        </record>

        <record id="action_linyan_invoice_tree1_view1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="linyan_invoice_tree"/>
            <field name="act_window_id" ref="action_linyan_invoice_tree1"/>
        </record>

        <record id="action_linyan_invoice_tree1_view2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="linyan_invoice_form"/>
            <field name="act_window_id" ref="action_linyan_invoice_tree1"/>
        </record>

        <record id="action_linyan_invoice_tree2" model="ir.actions.act_window">
            <field name="name">应付发票</field>
            <field name="res_model">linyan.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field eval="False" name="view_id"/>
            <field name="domain">[('invoice_type','=','in_invoice')]</field>
            <field name="context">{'default_invoice_type':'in_invoice', 'type':'in_invoice'}</field>
            <field name="search_view_id" ref="view_linyan_invoice_filter"/>
        </record>

        <record id="action_linyan_invoice_tree2_view1" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="linyan_invoice_supplier_tree"/>
            <field name="act_window_id" ref="action_linyan_invoice_tree2"/>
        </record>

        <record id="action_linyan_invoice_tree2_view2" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="linyan_invoice_supplier_form"/>
            <field name="act_window_id" ref="action_linyan_invoice_tree2"/>
        </record>

        <record id="view_linyan_payment_tree" model="ir.ui.view">
            <field name="name">linyan.payment.tree</field>
            <field name="model">linyan.payment</field>
            <field name="arch" type="xml">
                <tree edit="false">
                    <field name="name"/>
                    <field name="payment_date"/>
                    <field name="journal_id"/>
                    <field name="partner_id" string="客户"/>
                    <field name="amount"/>
                    <field name="remaining_amount"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="partner_type" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="view_linyan_supplier_payment_tree" model="ir.ui.view">
            <field name="name">linyan.supplier.payment.tree</field>
            <field name="model">linyan.payment</field>
            <field name="arch" type="xml">
                <tree edit="false">
                    <field name="name"/>
                    <field name="payment_date"/>
                    <field name="journal_id"/>
                    <field name="partner_id" string="供应商"/>
                    <field name="amount"/>
                    <field name="remaining_amount"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="partner_type" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="view_linyan_payment_search" model="ir.ui.view">
            <field name="name">linyan.payment.search</field>
            <field name="model">linyan.payment</field>
            <field name="arch" type="xml">
                <search string="Payments">
                    <field name="name"/>
                    <separator/>
                    <field name="partner_id"/>
                    <field name="journal_id"/>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_linyan_payment_kanban">
            <field name="name">linyan.payment.kanban</field>
            <field name="model">linyan.payment</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="remaining_amount"/>
                    <field name="amount"/>
                    <field name="face_date"/>
                    <field name="currency_id"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <strong><span><t t-esc="record.partner_id.value"/></span></strong>
                                    </div>
                                    <div class="col-xs-6 pull-right text-right">
                                        <strong><field name="amount" widget="monetary"/></strong>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <span><t t-esc="record.name.value"/></span>
                                    </div>
                                    <div class="col-xs-6">
                                        <span t-attf-class="pull-right text-right"><t t-esc="record.face_date.value"/></span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="view_account_linyan_payment_form" model="ir.ui.view">
            <field name="name">linyan.payment.form</field>
            <field name="model">linyan.payment</field>
            <field name="arch" type="xml">
                <form string="Register Payment" version="7">
                    <header>
                    </header>
                    <sheet>
                        <!-- <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" name="button_invoices"
                                    string="Invoices" type="object"
                                    attrs="{'invisible':[('has_invoices','=',False)]}" icon="fa-bars"/>
                            <field name="has_invoices" invisible="1"/>
                        </div> -->
                        <field name="id" invisible="1"/>
                        <div class="oe_title">
                            <h1><field name="name"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="payment_type" widget="radio" invisible="1"/>
                                <field name="partner_type" nolabel="1" widget="selection" string="" attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))], 'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))]}"/>
                                <field name="partner_id" nolabel="1" attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))], 'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))]}" context="{'default_is_company': True, 'default_supplier': payment_type == 'outbound', 'default_customer': payment_type == 'inbound'}"/>
                                <field name="journal_id" widget="selection"/>
                                <label for="amount"/>
                                <div name="amount_div" class="o_row">
                                    <field name="amount"/>
                                    <field name="currency_id" options="{'no_create': True, 'no_open': True}" groups="base.group_multi_currency"/>
                                </div>
                            </group>
                            <group>
                                <field name="payment_date"/>
                                <field name="communication"/>
                                <field name="face_date"/>
                                <field name="remaining_amount"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="应收\应付">
                                <field name="invoice_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_linyan_payments" model="ir.actions.act_window">
            <field name="name">实收</field>
            <field name="res_model">linyan.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="context">{'default_payment_type': 'inbound', 'default_partner_type': 'customer'}</field>
            <field name="domain">[('partner_type', '=', 'customer')]</field>
            <field name="view_id" ref="view_linyan_payment_tree"/>
        </record>

        <record id="action_linyan_payments_payable" model="ir.actions.act_window">
            <field name="name">实付</field>
            <field name="res_model">linyan.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="context">{'default_payment_type': 'outbound', 'default_partner_type': 'supplier'}</field>
            <field name="domain">[('partner_type', '=', 'supplier')]</field>
            <field name="view_id" ref="view_linyan_supplier_payment_tree"/>
        </record>

        <menuitem id="menu_action_linyan_invoice_tree1" name="应收账款" parent="linyan_base.menu_linyan_base_account" action="action_linyan_invoice_tree1" sequence="10"/>
        <menuitem id="menu_action_linyan_account_payments" name="实收" parent="linyan_base.menu_linyan_base_account" action="action_linyan_payments" sequence="15"/>
        <menuitem id="menu_action_linyan_invoice_tree2" name="应付账款" parent="linyan_base.menu_linyan_base_account" action="action_linyan_invoice_tree2" sequence="20"/>
        <menuitem id="menu_action_linyan_account_payments_payable" name="实付" parent="linyan_base.menu_linyan_base_account" action="action_linyan_payments_payable" sequence="25"/>

    </data>
</openerp>
